
# WIL - CORS
- 2022.08.14

## β“ [SOP(Same Origin Policy)]
- π“ SOP μ΄λ€? <br>
- CORSλ¥Ό μ•κΈ° μ΄μ „μ—, SOPμ— λ€ν•΄ μ•μ•„λ³΄μ.<br>
- SOPλ” λ‹¤λ¥Έ μ¶μ²μ λ¦¬μ†μ¤λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ„ μ ν•ν•λ” λ³΄μ• λ°©μ‹μ΄λ‹¤.<br>
- μ—¬κΈ°μ„ μ¶μ²λ” URLμ Protocol, Host, Port λ΅ κµ¬λ¶„ν•λ‹¤.<br>
- ν† ν°λ§μΌλ΅ μ‚¬μ©μλ¥Ό νλ‹¨ν•λ‹¤λ©΄.. ν΄λΌμ΄μ–ΈνΈμ™€ ν•΄μ»¤μ μ”μ²­μ„ κµ¬λ¶„ν•κΈ° νλ“¤κ²ƒμ΄λ‹¤.<br>
- λ°λ©΄μ— URLμ„ ν™•μΈν•λ‹¤λ©΄ ν΄λΌμ΄μ–ΈνΈμ μ¶μ²μ™€ ν•΄μ»¤μ μ¶μ²κ°€ μ„λ΅ λ‹¤λ¥Έ μ¶μ²λΌλ” κ²ƒμ„ ν™•μΈν•μ—¬, μ•…μμ μΈ μ”μ²­μ„ λ°©μ§€ν•  μ μλ‹¤.<br>
- μ„μ™€ κ°™μ€ μƒν™©, μ”μ²­μ μ¶μ²κ°€ λ‹¤λ¥΄λ‹¤λ©΄ Cross Origin SOPμ— μ„λ°μ΄λΌκ³  ν•λ‹¤.<br>
- ν•μ§€λ§ μ™Έλ¶€ λΌμ΄λΈλ¬λ¦¬λ„ μ‚¬μ©ν•΄μ•Ό ν•λ”λ° μ”μ²­κ³Ό λ¦¬μ†μ¤λ¥Ό λ§¤λ² λ™μΌν• μ¶μ²λ΅λ§ λ°›μ„ μλ” μ—†λ‹¤.<br>
- μ΄ λ–„ ν•„μ”ν• κ²ƒμ΄ CORS μ΄λ‹¤.
-----

## β“ [CORS(Corss Origin Resource Sharing)]
- π“ CORS λ€? <br>
- CORSλ€ λ‹¤λ¥Έ μ¶μ²μ μμ›μ„ κ³µμ ν•λ” κ²ƒμ΄λ‹¤.<br>
> κµμ°¨ μ¶μ² λ¦¬μ†μ¤ κ³µμ λ” μ¶”κ°€ HTTP ν—¤λ”λ¥Ό μ‚¬μ©ν•μ—¬, ν• μ¶μ²μ—μ„ μ‹¤ν–‰ μ¤‘μΈ μ›Ή μ–΄ν”λ¦¬μΌ€μ΄μ…μ΄<br>
> λ‹¤λ¥Έ μ¶μ²μ μ„ νƒν• μμ›μ— μ ‘κ·Όν•  μ μλ” κ¶ν•μ„ λ¶€μ—¬ν•λ„λ΅ λΈλΌμ°μ €μ—κ² μ•λ ¤μ£Όλ” μ²΄μ μ΄λ‹¤.<br>
- CORS μ ‘κ·Όμ μ–΄μ— μ‚¬μ©λλ” 3κ°€μ§€μ μ‹λ‚λ¦¬μ¤κ°€ μλ‹¤.<br>
-----
> β—οΈ**__λ‹¨μ μ”μ²­(Simple Request)__** <br>
> Preflight μ”μ²­ μ—†μ΄ λ°”λ΅ μ”μ²­μ„ λ³΄λ‚Έλ‹¤. Simple Requestλ” μ•„λμ™€ κ°™μ€ μ΅°κ±΄μ„ λ§μ΅±ν•΄μ•Όν•λ‹¤. <br><br>
> **__λ©”μ„λ“ : GET, POST, HEAD__** <br><br>
**__Content-Typeμ€ μ•„λ μ…‹ μ¤‘ ν•λ‚μ—¬μ•Ό ν•λ‹¤.__**<br>
application/x-www-form-urlencoded <br>
multipart/form-data <br>
text/plain <br><br>
**__ν—¤λ” : Accept, Accept-Language, Content-Language, Content-Type λ§ ν—μ© ν•λ‹¤.__** <br>

-----

> β—οΈ**__μ‚¬μ „ μ”μ²­(Preflight Request)__** <br>
> μ‚¬μ „ μ”μ²­μ€ OPTIONS λ©”μ„λ“λ¥Ό ν†µν•΄ λ‹¤λ¥Έ λ„λ©”μΈ λ¦¬μ†μ¤μ— μ”μ²­μ΄ κ°€λ¥ν•μ§€ ν™•μΈν•λ” μ‘μ—…μ΄λ‹¤. <br>
> μ”μ²­μ΄ κ°€λ¥ν• κ²ƒμ„ ν™•μΈν•λ©΄ μ‹¤μ  μ”μ²­μ„ λ³΄λ‚Έλ‹¤.<br>
> **__Preflight Request__**<br><br>
> 1.Origin : μ”μ²­ μ¶μ²<br>
> 2.Access-Control-Request-Method : μ‹¤μ  μ”μ²­μ λ©”μ„λ“<br>
> 3.Access-Control-Request-Headers : μ‹¤μ  μ”μ²­μ μ¶”κ°€ ν—¤λ”<br><br>

> **__Preflight Response__** <br><br>
> 1.Access-Control-Allow-Origin : ν—κ°€ μ¶μ² <br>
> 2.Access-Control-Allow-Methods : ν—κ°€ λ©”μ„λ“ <br>
> 3.Access-Control-Allow-Headers : ν—κ°€ ν—¤λ” <br>
> 4.Access-Control-Max-Age : Preflight μ‘λ‹µ μΊμ‹ μ‹κ°„ <br>
> μ—¬κΈ°μ„ Preflight Responseμ μ‘λ‹µ μ½”λ“λ” 200λ€μ—¬μ•Όν•κ³  Bodyλ” λΉ„μ–΄μλ” κ²ƒμ΄ μΆ‹λ‹¤.<br><br>

-----
> β—οΈ**__μΈμ¦ μ”μ²­(Credentialed Request)__** <br>
> μΈμ¦ κ΄€λ ¨ ν—¤λ”λ¥Ό ν¬ν•¨ν•  λ• μ‚¬μ©ν•λ” μ”μ²­μ΄λ‹¤.<br><br>
> 1. ν΄λΌμ΄μ–ΈνΈ : μΏ ν‚¤ λλ” JWT ν† ν°μ„ λ‹΄μ•„ λ³΄λ‚Ό κ²½μ° credentials : include λ¥Ό ν¬ν•¨ν•μ—¬ λ³΄λ‚Έλ‹¤.<br>
> 2. μ„λ²„ : ccess-Control-Allow-Credentials : true ν•΄μ•Ό ν΄λΌμ΄μ–ΈνΈμ μΈμ¦ ν¬ν•¨ μ”μ²­μ— ν—μ©μ΄ κ°€λ¥ν•λ‹¤.<br>

-----

> β—οΈ **__CORS__** <br>
> CORS ν•΄κ²° λ°©λ²•μ—λ” μ„Έ κ°€μ§€κ°€ μλ‹¤.
> ν”„λ΅ νΈ ν”„λ΅μ‹ μ„λ²„ μ„¤μ • : ν”„λ΅ νΈ μ„λ²„μ—μ„ λ°±μ—”λ“ μ„λ²„λ΅ μ”μ²­μ„ λ³΄λ‚Ό λ•, λ€μƒμ URLμ„ λ³€κ²½ν•λ‹¤. <br>
> μ§μ ‘ ν—¤λ” μ„¤μ • : μ§μ ‘ ν—¤λ”μ— μ„¤μ •μ„ μ¶”κ°€ν•λ‹¤.<br>
> μ¤ν”„λ§ λ¶€νΈ μ„¤μ • : μ„¤μ • ν΄λμ¤λ¥Ό λ§λ“¤κ³  WebMvcConfigurerμ„ κµ¬ν„ν•λ©΄ addCorsMappingsλ€ λ©”μ„λ“λ¥Ό μ‚¬μ©ν•μ—¬ CORSμ μ¶μ² λ° μ„¤μ • κ΄€λ¦¬λ¥Ό ν•  μ μλ‹¤.
